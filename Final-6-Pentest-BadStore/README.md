# Final 6: Informe de Pruebas de Penetración a BadStore

### Consigna del Final
Este final exigía la realización de un informe de pruebas de penetración a un entorno de laboratorio controlado. El objetivo era evaluar un sistema vulnerable, documentar las vulnerabilidades encontradas y presentar un informe claro con los hallazgos, el impacto y las recomendaciones de mitigación.

---

### Escenario Elegido: Pentest a BadStore

#### Objetivo y Alcance
* **Objetivo:** Evaluar la seguridad de la web BadStore
* **Alcance:** La máquina objetivo 10.0.0.10

#### Hallazgos
* **1. Inyección SQL (SQL Injection)**
    * Se ha identificado una vulnerabilidad de inyección SQL de severidad Crítica debido a la falta de validación de entradas de usuario en múltiples puntos de la aplicación.
    * **Puntos de Inyección:**
        * Formulario de inicio de sesión (Login)
        * Barra de búsqueda en la página principal
    * **Evidencia (Prueba de Concepto):**
        * Al ingresar un carácter especial (´), la aplicación falló y devolvió un mensaje de error detallado del servidor MySQL.
        * La respuesta del servidor reveló el error de sintaxis y expuso nombres de columnas de la base de datos (IN (itemnum, sdesc, ldesc)) y la ruta del archivo vulnerable (/usr/local/apache/cgi-bin/badstore.cgi).
    * **Impacto y Potencial de Explotación:**
        * Esta vulnerabilidad permitiría a un atacante sortear la autenticación o extraer información sensible de la base de datos, como nombres de usuario, contraseñas o información de productos.
        * Aunque el ataque de extracción de datos con UNION SELECT no pudo completarse debido a un límite de caracteres, el error de sintaxis indica que el sitio es vulnerable a este tipo de ataques más complejos.

* **2. Cross-site Scripting (XSS)**
    * **Severidad:** Alta.
    * **Punto de Inyección:** Se identificó XSS Almacenado de severidad alta debido a que la aplicación no filtra el código antes de guardarlo en su base de datos.
    * **Prueba de Concepto:** Al inyectar la carga útil `<script>alert(1)</script>`, el script se guardó y se ejecutó automáticamente.
    * **Impacto Potencial:** Un atacante podría inyectar un script para robar las cookies de sesión de otros usuarios, tomando el control de sus cuentas.

---

#### Metodología de Pruebas
Para asegurar un entorno de prueba aislado, se configuró la máquina de Kali Linux con dos adaptadores de red: uno en modo NAT para la conectividad a Internet, y un segundo adaptador en modo Red Interna para la comunicación privada con la máquina objetivo. La máquina de BadStore fue configurada con una dirección IP estática (10.0.0.10) en esa misma red interna, lo que permitió la ejecución de las pruebas de forma segura y controlada.

**Comandos Utilizados en la Consola**

* **Configuración de red:**
    ```bash
    sudo ifconfig eth1 10.0.0.11 netmask 255.255.255.0 up
    ping 10.0.0.10
    ```

* **Escaneo de puertos:**
    ```bash
    sudo nmap 10.0.0.10
    ```

* **Prueba de vulnerabilidades (Inyección de payloads):**
    ```bash
    Inyeccion SQL:
    ´
    ´ or 1=1 –
    ´ or 1=1#

    Inyeccion XSS:
    <script>alert(1)</script>
    ```

---

#### Conclusión y Recomendaciones
* **Conclusión:** La aplicación de BadStore es altamente vulnerable a ataques de inyección, lo que demuestra una falta de validación de entradas.
* **Recomendaciones:**
    * Validar y sanear las entradas: implementar filtros para limpiar todas las entradas del usuario antes de que sean procesadas.
    * Utilizar consultas parametrizadas: usar consultas preparadas para que la base de datos separe el código SQL de la entrada del usuario, lo que previene la inyección.
    * Configurar el manejo de errores: deshabilitar los mensajes de error detallados del servidor.

---
